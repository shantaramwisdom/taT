DROP TABLE IF EXISTS ${databasename}.erpdw_subledgerjournallinedetail;
CREATE EXTERNAL TABLE ${databasename}.erpdw_subledgerjournallinedetail
(
recorded_timestamp timestamp,
source_system_name string,
generalledgersubledgerjournalheaderid string,
generalledgersubledgerjournalheadername string,
generalledgersubledgerjournalheaderdescription string,
generalledgersubledgerjournallinenumber BIGINT,
generalledgersubledgerjournallinedescription string,
generalledgerjournalname string,
generalledgerjournalbatchname string,
generalledgerjournallinenumber integer,
generalledgerjournalsourcecategory string,
generalledgerledgername string,
geacledgercode string,
geacledgerdescription string,
generalledgeraccountingperiod string,
activityreportdate timestamp,
generalledgersubledgerpostdate timestamp,
generalledgerreversalindicator string,
generalledgersubledgername string,
generalledgersubledgereventtypecode string,
chartofaccountscompanycode string,
chartofaccountsbusinesscode string,
chartofaccountsdepartmentcode string,
chartofaccountsaccountcode string,
chartofaccountsproductcode string,
chartofaccountsintercompanycode string,
chartofaccountssummaryproductcode string,
generalledgertransactioncurrencycode string,
generalledgertransactioncurrencyamount decimal(18,6),
generalledgercurrencyconversiondate date,
generalledgercurrencyconversionrate string,
generalledgerreportingcurrencyexchangerate decimal(18,6),
generalledgerreportingcurrencycode string,
generalledgerreportingcurrencyamount decimal(18,6),
generalledgersubledgerjournalcreateddate timestamp,
generalledgersubledgerjournalcreator string,
generalledgersubledgerjournallastupdatedate timestamp,
generalledgersubledgerjournallastupdatedby string,
sourcesystem string,
contractnumber string,
sourcefundidentifier string,
reinsurancetreatynumber string,
reinsurancecounterpartyreportinggroup string,
sourcesystemreinsurancecounterpartycode string,
originatinggeneralledgerdescription string,
originatinggeneralledgerid string,
originatinggeneralledgerprojectcode string,
activitygeneralledgerapplicationarea string,
activitygeneralledgersourcecode string,
activitygeneralledgerfullsourcecode string,
generalledgerdatatype string,
generalledgerreversaldate date,
activityaccountingid string,
generalledgeroriginalsubledgername string,
contractsourcemarketingorganizationcode string,
ifrs17reportingcashflowtype string,
activitysourcetransactioncode string,
checknumber string,
groupcontractnumber string,
sourcesystemgeneralledgeraccountnumber string,
sourcesystemgroupcontractnumber string,
activityreversalcode string,
contractissuedate date,
reinsurancecounterpartytype string,
ifrs17measurementmodel string,
activitysourceoriginatinguserid string,
reinsurancetreatybasis string,
contractissuedatecode string,
ifrs17portfolio string,
ifrs17grouping string,
ifrs17cohort string,
ifrs17profitability string,
cessionidentifier string,
activitydepositsourcebatchidentifier string,
contractsourcesystemname string,
reinsurancegroupindividualflag string,
plancode string,
sourcesystemactivitydescription string,
statutoryresidentcountrycode string,
statutoryresidentstatecode string,
legalcompanycode string,
generalledgeraccountnumber string,
generalledgeraccountdescription string,
generalledgeraccountsuffix string,
centerumber string,
activitywithholdingtaxjurisdiction string,
activitywithholdingtaxjurisdictioncountrycode string,
legalcompanyname string,
generalledgerlineofbusinessdescription string,
centerdescription string,
activityamounttype string,
activitytype string,
activitytypegroup string,
assetclasscode string,
cessionidentifier string,
contractadministrationlocationcode string,
contractdurationinyears string,
contracteffectivedate date,
contractissueage string,
contractsourcaccountingcenterdeviator string,
fundclassindicator string,
generalledgerdetaildebitcreditindicator string,
generalledgersubledgeraccountingclass string,
generalledgersubledgerjournalpreparer string,
instrumentcode string,
investmentportfoliocode string,
primaryinsuredprimarypostalcode string,
reinsuranceaccountflag string,
reinsurancegroupindividualflag string,
sourceactivityparentid string,
sourcelegalentitycode string,
transactiontargettype string,
transactionclass string,
transactionfeetype string,
transactionidertype string,
transactiontaxtype string,
treatycomponentidentifier string,
typeofbusinessreinsured string
)
PARTITIONED BY (
cycle_date date,
batch_id int)
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
'${s3bucketname}/${projectname}/curated/erpdw/erpdw/erpdw_subledgerjournallinedetail';
MSCK REPAIR TABLE ${databasename}.erpdw_subledgerjournallinedetail SYNC PARTITIONS;